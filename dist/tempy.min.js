/*! tempy.js 2014-09-15 */
!function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define(b):a.Tempy=b()}(this,function(){function a(a){this.string=a,this.tail=a,this.pos=0}a.prototype={eos:function(){return""===this.tail},scan:function(a){var b=this.tail.match(a);if(!b||0!==b.index)return!1;var c=b[0];return this.tail=this.tail.substring(c.length),this.pos+=c.length,b[0]},scanUntil:function(a){var b,c,d=this.tail.match(a);return null===d?(b=this.tail,this.tail="",this.pos+=b.length,b):(c=d.index,b=this.tail.substring(0,c),this.tail=this.tail.substring(c),this.pos+=c,b)}};var b=function(){};return b.read=function(b){var c={},d=/[\n\r;]|(\}\})|(--)/,e=/[\n\r;]/,f=function(a){return a.replace(/(^\s*)|(\s*$)/g,"")},g=function(a){var b,d=c;for(a=a.split(".");b=a.shift();){if("undefined"==typeof d[b])throw new Error("no value");d=d[b]}return d},h=function(a){return i(a)},i=function(a){if(a=f(a),/^true$/i.test(a))return!0;if(/^false$/i.test(a))return!1;if(/^null$/i.test(a))return null;if(/^(0|[1-9][0-9]*)$/.test(a))return parseInt(a);if(/^"((?:[^"]|\\")*)"$/.test(a))return a.slice(1,-1).replace(/\\"/,'"').replace(/\\n/,"\n");if(/^'([^']*)'$/.test(a))return a.slice(1,-1);if(/^([a-zA-Z_][a-zA-Z0-9_]*)(\.(([a-zA-Z_][a-zA-Z0-9_]*)|(0|[1-9][0-9]*)))*$/.test(a))try{return g(a)}catch(b){return}throw new Error("알 수 없는 타입")},j=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push({k:c,v:a[c]});return b},k=function(a){return a[a.length-1]};return{assign:function(a,b){c[a]=b},render:function(g){for(idx in g)this.assign(idx,g[idx]);var l,m=new a("}}"+b+"{{"),n="",o={t:0,isp:!0},p=[];for(p.push(o);!m.eos();)if(m.scan(/^\s*\}\}/))l=m.scanUntil(/\{\{/),o.isp&&(n+=l),m.scan(/\{\{\s*/);else if(m.scan(/^\s*\=\s*/))l=m.scanUntil(d),o.isp&&(l=h(l),"undefined"!=typeof l&&null!==l&&(n+=l.toString())),m.scan(e);else if(m.scan(/^\s*--/))l=m.scanUntil(d),m.scan(e);else if(m.scan(/^\s*\?/))l=m.scanUntil(d),l=h(l),o=l?{t:1,isp:o.isp,status:1}:{t:1,isp:!1,status:0},p.push(o),m.scan(e);else{if(!m.scan(/^\s*\@/)){switch(m.scan(/^\s*\;/),o.t){case 1:m.scan(/^\s*\:\?/)&&(l=m.scanUntil(d),1===o.status?o.isp=!1:(l=h(l),l&&(o.isp=!0,o.status=1)),m.scan(e)),m.scan(/^\s*\:/)&&(o.isp=1===o.status?!1:!0,m.scan(e)),m.scan(/^\s*\//)&&(p.pop(),o=k(p),m.scan(e));continue;case 2:if(m.scan(/^\s*\//)){if(0===o.status){var q=o.iter;q.i++,q.i<q.len?(null!==q.key&&(c[q.key]=q.value[q.i].k),null!==q.name&&(c[q.name]=q.value[q.i].v),m.tail=o.tail,m.pos=o.pos):o.status=1}1===o.status&&(p.pop(),o=k(p),m.scan(e))}continue}n+="<!--Parsing Error-->";break}l=m.scanUntil(d);var r,q=l.split(":"),s=j(i(q[0])||""),t=null,u=f(q[1]),v=s.length;-1!==(r=u.indexOf(","))&&(t=f(u.substring(0,r)),u=f(u.substring(r+1)),""==t&&(t=null),""==u&&(u=null)),0===v||o.isp===!1?o={t:2,isp:!1,status:1}:(null!==t&&(c[t]=s[0].k),null!==u&&(c[u]=s[0].v),o={t:2,isp:o.isp,status:0,tail:m.tail,pos:m.pos,iter:{key:t,name:u,value:s,len:v,i:0}}),p.push(o),m.scan(e)}return n}}},b});