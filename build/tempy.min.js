(function(b,a){if(typeof exports==="object"){module.exports=a()}else{if(typeof define==="function"&&define.amd){define(a)}else{b.Tempy=a()}}})(this,function(){function a(c){this.string=c;this.tail=c;this.pos=0}a.prototype={eos:function(){return this.tail===""},scan:function(e){var d=this.tail.match(e);if(!d||d.index!==0){return false}var c=d[0];this.tail=this.tail.substring(c.length);this.pos+=c.length;return d[0]},scanUntil:function(f){var c,e,d=this.tail.match(f);if(d===null){c=this.tail;this.tail="";this.pos+=c.length;return c}e=d.index;c=this.tail.substring(0,e);this.tail=this.tail.substring(e);this.pos+=e;return c}};var b={};b.read=function(e){var f={},h=/[\n\r;]|(\}\})|(--)/,c=/[\n\r;]/,g=function(m){return m.replace(/(^\s*)|(\s*$)/g,"")},d=function(o){var n,m=f;o=o.split(".");while(n=o.shift()){if(typeof m[n]==="undefined"){throw new Error("no value")}m=m[n]}return m},i=function(m){return j(m)},j=function(m){m=g(m);if(/^true$/i.test(m)){return true}if(/^false$/i.test(m)){return false}if(/^null$/i.test(m)){return null}if(/^(0|[1-9][0-9]*)$/.test(m)){return parseInt(m)}if(/^"((?:[^"]|\\")*)"$/.test(m)){return m.slice(1,-1).replace(/\\"/,'"').replace(/\\n/,"\n")}if(/^'([^']*)'$/.test(m)){return m.slice(1,-1)}if(/^([a-zA-Z_][a-zA-Z0-9_]*)(\.(([a-zA-Z_][a-zA-Z0-9_]*)|(0|[1-9][0-9]*)))*$/.test(m)){try{return d(m)}catch(n){return}}throw new Error("알 수 없는 타입")},l=function(o){var m=[];for(var n in o){if(o.hasOwnProperty(n)){m.push({k:n,v:o[n]})}}return m},k=function(m){return m[m.length-1]};return{assign:function(m,n){f[m]=n},render:function(w){for(idx in w){this.assign(idx,w[idx])}var r=new a("}}"+e+"{{"),y="",t,u={t:0,isp:true},v=[];v.push(u);while(!r.eos()){if(r.scan(/^\s*\}\}/)){t=r.scanUntil(/\{\{/);if(u.isp){y+=t}r.scan(/\{\{\s*/);continue}if(r.scan(/^\s*\=\s*/)){t=r.scanUntil(h);if(u.isp){t=i(t);if(typeof t!=="undefined"&&t!==null){y+=t.toString()}}r.scan(c);continue}if(r.scan(/^\s*--/)){t=r.scanUntil(h);r.scan(c);continue}if(r.scan(/^\s*\?/)){t=r.scanUntil(h);t=i(t);if(t){u={t:1,isp:u.isp,status:1}}else{u={t:1,isp:false,status:0}}v.push(u);r.scan(c);continue}if(r.scan(/^\s*\@/)){t=r.scanUntil(h);var q,s=t.split(":"),n=l(j(s[0])||""),m=null,o=g(s[1]),x=n.length;if((q=o.indexOf(","))!==-1){m=g(o.substring(0,q));o=g(o.substring(q+1));if(m==""){m=null}if(o==""){o=null}}if(x===0||u.isp===false){u={t:2,isp:false,status:1}}else{if(m!==null){f[m]=n[0].k}if(o!==null){f[o]=n[0].v}u={t:2,isp:u.isp,status:0,tail:r.tail,pos:r.pos,iter:{key:m,name:o,value:n,len:x,i:0}}}v.push(u);r.scan(c);continue}r.scan(/^\s*\;/);switch(u.t){case 1:if(r.scan(/^\s*\:\?/)){t=r.scanUntil(h);if(u.status===1){u.isp=false}else{t=i(t);if(t){u.isp=true;u.status=1}}r.scan(c)}if(r.scan(/^\s*\:/)){if(u.status===1){u.isp=false}else{u.isp=true}r.scan(c)}if(r.scan(/^\s*\//)){v.pop();u=k(v);r.scan(c)}continue;case 2:if(r.scan(/^\s*\//)){if(u.status===0){var s=u.iter;s.i++;if(s.i<s.len){if(s.key!==null){f[s.key]=s.value[s.i].k}if(s.name!==null){f[s.name]=s.value[s.i].v}r.tail=u.tail;r.pos=u.pos}else{u.status=1}}if(u.status===1){v.pop();u=k(v);r.scan(c)}}continue}y+="<!--Parsing Error-->";break}return y}}};return b});