(function(b,a){if(typeof exports==="object"){module.exports=a()}else{if(typeof define==="function"&&define.amd){define(a)}else{b.Tempy=a()}}})(this,function(){function a(c){this.string=c;this.tail=c;this.pos=0}a.prototype={eos:function(){return this.tail===""},scan:function(e){var d=this.tail.match(e);if(!d||d.index!==0){return false}var c=d[0];this.tail=this.tail.substring(c.length);this.pos+=c.length;return d[0]},scanUntil:function(f){var c,e,d=this.tail.match(f);if(d===null){c=this.tail;this.tail="";this.pos+=c.length;return c}e=d.index;c=this.tail.substring(0,e);this.tail=this.tail.substring(e);this.pos+=e;return c}};var b={};b.read=function(j){var f={},g=/[\n\r;]|(\}\})|(--)/,i=/[\n\r;]/,d=function(k){return k.replace(/(^\s*)|(\s*$)/g,"")},h=function(n){var m,l=f;n=n.split(".");while(m=n.shift()){if(typeof l[m]==="undefined"){throw new Error("There is no variable")}l=l[m]}return l},e=function(k){k=d(k);if(/^true$/i.test(k)){return true}if(/^false$/i.test(k)){return false}if(/^null$/i.test(k)){return null}if(/^(0|[1-9][0-9]*)$/.test(k)){return parseInt(k)}if(/^"((?:[^"]|\\")*)"$/.test(k)){return k.slice(1,-1).replace(/\\"/,'"').replace(/\\n/,"\n")}if(/^'([^']*)'$/.test(k)){return k.slice(1,-1)}if(/^([a-zA-Z_][a-zA-Z0-9_]*)(\.(([a-zA-Z_][a-zA-Z0-9_]*)|(0|[1-9][0-9]*)))*$/.test(k)){try{return h(k)}catch(l){return}}throw new Error("알 수 없는 타입")},c=function(k){return k[k.length-1]};return{assign:function(k,l){f[k]=l},render:function(r){for(idx in r){this.assign(idx,r[idx])}var m=new a("}}"+j+"{{"),t="",o,p={type:0,is_print:true},q=[];q.push(p);while(!m.eos()){if(m.scan(/^\s*\}\}/)){o=m.scanUntil(/\{\{/);if(p.is_print){t+=o}m.scan(/\{\{\s*/);continue}if(m.scan(/^\s*--/)){o=m.scanUntil(g);m.scan(i);continue}if(m.scan(/^\s*\=\s*/)){o=m.scanUntil(g);if(p.is_print){o=e(o);if(typeof o!=="undefined"&&o!==null){t+=o.toString()}}m.scan(i);continue}if(m.scan(/^\s*\?/)){o=m.scanUntil(g);o=e(o);if(o){p={type:1,is_print:p.is_print,status:1}}else{p={type:1,is_print:false,status:0}}q.push(p);m.scan(i);continue}if(m.scan(/^\s*\@/)){o=m.scanUntil(g);var n=o.split("->"),l=d(n[1]),k=e(n[0])||[],s=k.length;if(s===0||p.is_print===false){p={type:2,is_print:false,status:1}}else{f[l]=k[0];p={type:2,is_print:p.is_print,status:0,tail:m.tail,pos:m.pos,iterator:{name:l,value:k,len:s,i:0}}}q.push(p);m.scan(i);continue}m.scan(/^\s*\;/);switch(p.type){case 1:if(m.scan(/^\s*\:\?/)){o=m.scanUntil(g);if(p.status===1){p.is_print=false}else{o=e(o);if(o){p.is_print=true;p.status=1}}m.scan(i)}if(m.scan(/^\s*\:/)){if(p.status===1){p.is_print=false}else{p.is_print=true}m.scan(i)}if(m.scan(/^\s*\//)){q.pop();p=c(q);m.scan(i)}continue;case 2:if(m.scan(/^\s*\//)){if(p.status===0){var n=p.iterator;n.i++;if(n.i<n.len){f[n.name]=n.value[n.i];m.tail=p.tail;m.pos=p.pos}else{p.status=1}}if(p.status===1){q.pop();p=c(q);m.scan(i)}}continue}}return t}}};return b});